/**
 * skylark-faiconpicker - A version of fontawesome-iconpicker that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-faiconpicker/
 * @license MIT
 */
define(["skylark-langx/skylark","skylark-jquery","./allIcons"],function(t,i,e){"use strict";var n=function(t){return!1===t||""===t||null===t||void 0===t},o=function(t){return i(t).length>0},s=function(t){return"string"==typeof t||t instanceof String},r=function(t,e){return-1!==i.inArray(t,e)},c=function(t,e){this._id=c._idCounter++,this.element=i(t).addClass("iconpicker-element"),this._trigger("iconpickerCreate",{iconpickerValue:this.iconpickerValue}),this.options=i.extend({},c.defaultOptions,this.element.data(),e),this.options.templates=i.extend({},c.defaultOptions.templates,this.options.templates),this.options.originalPlacement=this.options.placement,this.container=!!o(this.options.container)&&i(this.options.container),!1===this.container&&(this.element.is(".dropdown-toggle")?this.container=i("~ .dropdown-menu:first",this.element):this.container=this.element.is("input,textarea,button,.btn")?this.element.parent():this.element),this.container.addClass("iconpicker-container"),this.isDropdownMenu()&&(this.options.placement="inline"),this.input=!!this.element.is("input,textarea")&&this.element.addClass("iconpicker-input"),!1===this.input&&(this.input=this.container.find(this.options.input),this.input.is("input,textarea")||(this.input=!1)),this.component=this.isDropdownMenu()?this.container.parent().find(this.options.component):this.container.find(this.options.component),0===this.component.length?this.component=!1:this.component.find("i").addClass("iconpicker-component"),this._createPopover(),this._createIconpicker(),0===this.getAcceptButton().length&&(this.options.mustAccept=!1),this.isInputGroup()?this.container.parent().append(this.popover):this.container.append(this.popover),this._bindElementEvents(),this._bindWindowEvents(),this.update(this.options.selected),this.isInline()&&this.show(),this._trigger("iconpickerCreated",{iconpickerValue:this.iconpickerValue})};return c._idCounter=0,c.defaultOptions={title:!1,selected:!1,defaultValue:!1,placement:"bottom",collision:"none",animation:!0,hideOnSelect:!1,showFooter:!1,searchInFooter:!1,mustAccept:!1,selectedCustomClass:"bg-primary",icons:e,fullClassFormatter:function(t){return t},input:"input,.iconpicker-input",inputSearch:!1,container:!1,component:".input-group-addon,.iconpicker-component",templates:{popover:'<div class="iconpicker-popover popover"><div class="arrow"></div><div class="popover-title"></div><div class="popover-content"></div></div>',footer:'<div class="popover-footer"></div>',buttons:'<button class="iconpicker-btn iconpicker-btn-cancel btn btn-default btn-sm">Cancel</button> <button class="iconpicker-btn iconpicker-btn-accept btn btn-primary btn-sm">Accept</button>',search:'<input type="search" class="form-control iconpicker-search" placeholder="Type to filter" />',iconpicker:'<div class="iconpicker"><div class="iconpicker-items"></div></div>',iconpickerItem:'<a role="button" href="javascript:;" class="iconpicker-item"><i></i></a>'}},c.batch=function(t,e){var n=Array.prototype.slice.call(arguments,2);return i(t).each(function(){var t=i(this).data("iconpicker");t&&t[e].apply(t,n)})},c.prototype={constructor:c,options:{},_id:0,_trigger:function(t,e){e=e||{},this.element.trigger(i.extend({type:t,iconpickerInstance:this},e))},_createPopover:function(){this.popover=i(this.options.templates.popover);var t=this.popover.find(".popover-title");if(this.options.title&&t.append(i('<div class="popover-title-text">'+this.options.title+"</div>")),this.hasSeparatedSearchInput()&&!this.options.searchInFooter?t.append(this.options.templates.search):this.options.title||t.remove(),this.options.showFooter&&!n(this.options.templates.footer)){var e=i(this.options.templates.footer);this.hasSeparatedSearchInput()&&this.options.searchInFooter&&e.append(i(this.options.templates.search)),n(this.options.templates.buttons)||e.append(i(this.options.templates.buttons)),this.popover.append(e)}return!0===this.options.animation&&this.popover.addClass("fade"),this.popover},_createIconpicker:function(){var t=this;this.iconpicker=i(this.options.templates.iconpicker);var e=function(e){var n=i(this);n.is("i")&&(n=n.parent()),t._trigger("iconpickerSelect",{iconpickerItem:n,iconpickerValue:t.iconpickerValue}),!1===t.options.mustAccept?(t.update(n.data("iconpickerValue")),t._trigger("iconpickerSelected",{iconpickerItem:this,iconpickerValue:t.iconpickerValue})):t.update(n.data("iconpickerValue"),!0),t.options.hideOnSelect&&!1===t.options.mustAccept&&t.hide()},n=i(this.options.templates.iconpickerItem),o=[];for(var s in this.options.icons)if("string"==typeof this.options.icons[s].title){var r=n.clone();if(r.find("i").addClass(this.options.fullClassFormatter(this.options.icons[s].title)),r.data("iconpickerValue",this.options.icons[s].title).on("click.iconpicker",e),r.attr("title","."+this.options.icons[s].title),this.options.icons[s].searchTerms.length>0){for(var c="",p=0;p<this.options.icons[s].searchTerms.length;p++)c=c+this.options.icons[s].searchTerms[p]+" ";r.attr("data-search-terms",c)}o.push(r)}return this.iconpicker.find(".iconpicker-items").append(o),this.popover.find(".popover-content").append(this.iconpicker),this.iconpicker},_isEventInsideIconpicker:function(t){var e=i(t.target);return!((!e.hasClass("iconpicker-element")||e.hasClass("iconpicker-element")&&!e.is(this.element))&&0===e.parents(".iconpicker-popover").length)},_bindElementEvents:function(){var t=this;this.getSearchInput().on("keyup.iconpicker",function(){t.filter(i(this).val().toLowerCase())}),this.getAcceptButton().on("click.iconpicker",function(){var i=t.iconpicker.find(".iconpicker-selected").get(0);t.update(t.iconpickerValue),t._trigger("iconpickerSelected",{iconpickerItem:i,iconpickerValue:t.iconpickerValue}),t.isInline()||t.hide()}),this.getCancelButton().on("click.iconpicker",function(){t.isInline()||t.hide()}),this.element.on("focus.iconpicker",function(i){t.show(),i.stopPropagation()}),this.hasComponent()&&this.component.on("click.iconpicker",function(){t.toggle()}),this.hasInput()&&this.input.on("keyup.iconpicker",function(e){r(e.keyCode,[38,40,37,39,16,17,18,9,8,91,93,20,46,186,190,46,78,188,44,86])?t._updateFormGroupStatus(!1!==t.getValid(this.value)):t.update(),!0===t.options.inputSearch&&t.filter(i(this).val().toLowerCase())})},_bindWindowEvents:function(){var t=i(window.document),e=this,n=".iconpicker.inst"+this._id;i(window).on("resize.iconpicker"+n+" orientationchange.iconpicker"+n,function(t){e.popover.hasClass("in")&&e.updatePlacement()}),e.isInline()||t.on("mouseup"+n,function(t){e._isEventInsideIconpicker(t)||e.isInline()||e.hide()})},_unbindElementEvents:function(){this.popover.off(".iconpicker"),this.element.off(".iconpicker"),this.hasInput()&&this.input.off(".iconpicker"),this.hasComponent()&&this.component.off(".iconpicker"),this.hasContainer()&&this.container.off(".iconpicker")},_unbindWindowEvents:function(){i(window).off(".iconpicker.inst"+this._id),i(window.document).off(".iconpicker.inst"+this._id)},updatePlacement:function(t,e){t=t||this.options.placement,this.options.placement=t,e=!0===(e=e||this.options.collision)?"flip":e;var n={at:"right bottom",my:"right top",of:this.hasInput()&&!this.isInputGroup()?this.input:this.container,collision:!0===e?"flip":e,within:window};if(this.popover.removeClass("inline topLeftCorner topLeft top topRight topRightCorner rightTop right rightBottom bottomRight bottomRightCorner bottom bottomLeft bottomLeftCorner leftBottom left leftTop"),"object"==typeof t)return this.popover.pos(i.extend({},n,t));switch(t){case"inline":n=!1;break;case"topLeftCorner":n.my="right bottom",n.at="left top";break;case"topLeft":n.my="left bottom",n.at="left top";break;case"top":n.my="center bottom",n.at="center top";break;case"topRight":n.my="right bottom",n.at="right top";break;case"topRightCorner":n.my="left bottom",n.at="right top";break;case"rightTop":n.my="left bottom",n.at="right center";break;case"right":n.my="left center",n.at="right center";break;case"rightBottom":n.my="left top",n.at="right center";break;case"bottomRightCorner":n.my="left top",n.at="right bottom";break;case"bottomRight":n.my="right top",n.at="right bottom";break;case"bottom":n.my="center top",n.at="center bottom";break;case"bottomLeft":n.my="left top",n.at="left bottom";break;case"bottomLeftCorner":n.my="right top",n.at="left bottom";break;case"leftBottom":n.my="right top",n.at="left center";break;case"left":n.my="right center",n.at="left center";break;case"leftTop":n.my="right bottom",n.at="left center";break;default:return!1}return this.popover.css({display:"inline"===this.options.placement?"":"block"}),!1!==n?this.popover.pos(n).css("maxWidth",i(window).width()-this.container.offset().left-5):this.popover.css({top:"auto",right:"auto",bottom:"auto",left:"auto",maxWidth:"none"}),this.popover.addClass(this.options.placement),!0},_updateComponents:function(){if(this.iconpicker.find(".iconpicker-item.iconpicker-selected").removeClass("iconpicker-selected "+this.options.selectedCustomClass),this.iconpickerValue&&this.iconpicker.find("."+this.options.fullClassFormatter(this.iconpickerValue).replace(/ /g,".")).parent().addClass("iconpicker-selected "+this.options.selectedCustomClass),this.hasComponent()){var t=this.component.find("i");t.length>0?t.attr("class",this.options.fullClassFormatter(this.iconpickerValue)):this.component.html(this.getHtml())}},_updateFormGroupStatus:function(t){return!!this.hasInput()&&(!1!==t?this.input.parents(".form-group:first").removeClass("has-error"):this.input.parents(".form-group:first").addClass("has-error"),!0)},getValid:function(t){s(t)||(t="");var e=""===t;t=i.trim(t);for(var n=!1,o=0;o<this.options.icons.length;o++)if(this.options.icons[o].title===t){n=!0;break}return!(!n&&!e)&&t},setValue:function(t){var i=this.getValid(t);return!1!==i?(this.iconpickerValue=i,this._trigger("iconpickerSetValue",{iconpickerValue:i}),this.iconpickerValue):(this._trigger("iconpickerInvalid",{iconpickerValue:t}),!1)},getHtml:function(){return'<i class="'+this.options.fullClassFormatter(this.iconpickerValue)+'"></i>'},setSourceValue:function(t){return!1!==(t=this.setValue(t))&&""!==t&&(this.hasInput()?this.input.val(this.iconpickerValue):this.element.data("iconpickerValue",this.iconpickerValue),this._trigger("iconpickerSetSourceValue",{iconpickerValue:t})),t},getSourceValue:function(t){var i=t=t||this.options.defaultValue;return void 0!==(i=this.hasInput()?this.input.val():this.element.data("iconpickerValue"))&&""!==i&&null!==i&&!1!==i||(i=t),i},hasInput:function(){return!1!==this.input},isInputSearch:function(){return this.hasInput()&&!0===this.options.inputSearch},isInputGroup:function(){return this.container.is(".input-group")},isDropdownMenu:function(){return this.container.is(".dropdown-menu")},hasSeparatedSearchInput:function(){return!1!==this.options.templates.search&&!this.isInputSearch()},hasComponent:function(){return!1!==this.component},hasContainer:function(){return!1!==this.container},getAcceptButton:function(){return this.popover.find(".iconpicker-btn-accept")},getCancelButton:function(){return this.popover.find(".iconpicker-btn-cancel")},getSearchInput:function(){return this.popover.find(".iconpicker-search")},filter:function(t){if(n(t))return this.iconpicker.find(".iconpicker-item").show(),i(!1);var e=[];return this.iconpicker.find(".iconpicker-item").each(function(){var n=i(this),o=n.attr("title").toLowerCase();o=o+" "+(n.attr("data-search-terms")?n.attr("data-search-terms").toLowerCase():"");var s=!1;try{s=new RegExp("(^|\\W)"+t,"g")}catch(t){s=!1}!1!==s&&o.match(s)?(e.push(n),n.show()):n.hide()}),e},show:function(){if(this.popover.hasClass("in"))return!1;i.iconpicker.batch(i(".iconpicker-popover.in:not(.inline)").not(this.popover),"hide"),this._trigger("iconpickerShow",{iconpickerValue:this.iconpickerValue}),this.updatePlacement(),this.popover.addClass("in"),setTimeout(i.proxy(function(){this.popover.css("display",this.isInline()?"":"block"),this._trigger("iconpickerShown",{iconpickerValue:this.iconpickerValue})},this),this.options.animation?300:1)},hide:function(){if(!this.popover.hasClass("in"))return!1;this._trigger("iconpickerHide",{iconpickerValue:this.iconpickerValue}),this.popover.removeClass("in"),setTimeout(i.proxy(function(){this.popover.css("display","none"),this.getSearchInput().val(""),this.filter(""),this._trigger("iconpickerHidden",{iconpickerValue:this.iconpickerValue})},this),this.options.animation?300:1)},toggle:function(){this.popover.is(":visible")?this.hide():this.show(!0)},update:function(t,i){return t=t||this.getSourceValue(this.iconpickerValue),this._trigger("iconpickerUpdate",{iconpickerValue:this.iconpickerValue}),!0===i?t=this.setValue(t):(t=this.setSourceValue(t),this._updateFormGroupStatus(!1!==t)),!1!==t&&this._updateComponents(),this._trigger("iconpickerUpdated",{iconpickerValue:this.iconpickerValue}),t},destroy:function(){this._trigger("iconpickerDestroy",{iconpickerValue:this.iconpickerValue}),this.element.removeData("iconpicker").removeData("iconpickerValue").removeClass("iconpicker-element"),this._unbindElementEvents(),this._unbindWindowEvents(),i(this.popover).remove(),this._trigger("iconpickerDestroyed",{iconpickerValue:this.iconpickerValue})},disable:function(){return!!this.hasInput()&&(this.input.prop("disabled",!0),!0)},enable:function(){return!!this.hasInput()&&(this.input.prop("disabled",!1),!0)},isDisabled:function(){return!!this.hasInput()&&!0===this.input.prop("disabled")},isInline:function(){return"inline"===this.options.placement||this.popover.hasClass("inline")}},i.iconpicker=c,i.fn.iconpicker=function(t){return this.each(function(){var e=i(this);e.data("iconpicker")||e.data("iconpicker",new c(this,"object"==typeof t?t:{}))})},t.attach("intg.FaIconPicker",c)});
//# sourceMappingURL=sourcemaps/IconPicker.js.map
